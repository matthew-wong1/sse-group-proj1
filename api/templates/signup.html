{% extends "layout.html" %}

{% block header %}
    {% include "oauth_meta.html" %}
{% endblock %}

{% block body %}
{% if exception %}
<div id="alert-popup" class="absolute top-20 left-1/2 transform -translate-x-1/2 flex items-center p-4 mb-4 rounded-lg text-red-800 border-t-4 shadow-gray-400 shadow-md border-red-300 bg-red-50 opacity-100 transition-opacity duration-500" role="alert" style="display: flex">
    <svg class="flex-shrink-0 w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
        <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
    </svg>
    <div class="ms-3 text-sm font-medium">
        Failed to sign up: {{ exception }}. Please try again later.
    </div>
</div>

{% endif %} 

<div class="p-form">
    <form action="/signup" method="post" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 max-w-sm mx-auto">
        <!-- Username field-->
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="username">
            Username
            </label>
            <input class="shadow appearance-none border border-black rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="username" name="username" type="text" value="{{ username }}" required>
            <!-- Error messages -->
            {% if 'username' in errors %}
                <p class="text-red-500 text-xs italic">{{ errors['username'] }}</p> 
            {% endif %}
        </div>

        <!-- Password field -->
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
            Password
            </label>
            <input class="shadow appearance-none border border-black rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" name="password" type="password" required pattern="^.{8,}" title="Must be at least 8 characters long">
            <!-- Error messages -->
            {% if 'password' in errors %}
                <p class="text-red-500 text-xs italic">{{ errors['password'] }}</p> 
            {% endif %}
        </div>

        <!-- Confirm password field -->
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="repeat_password">
            Enter your password again
            </label>
            <input class="shadow appearance-none border border-black rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="repeat_password" name="repeat_password" type="password" required>
            <!-- Error messages -->
            {% if 'confirmation' in errors %}
                <p class="text-red-500 text-xs italic">{{ errors['confirmation'] }}</p> 
            {% endif %}
            
        </div>

        <!-- Submit buttons -->
        <div class="flex items-center justify-between">
            <button class="bg-logo-contrast hover:bg-logo-contrast-darker text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
            Sign Up
            </button>
            <a class="inline-block align-baseline font-bold text-sm text-logo-contrast hover:text-logo-contrast-darker" href="/login">
            Already have an account?
            </a>
        </div>

        <!-- Sign in with Google button-->
        {% include "oauth_buttons.html" %}
    </form>
</div>

<script src="{{ url_for('static', filename='/javascript/index.js') }}"></script>

{% endblock %}