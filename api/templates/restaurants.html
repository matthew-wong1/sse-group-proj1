<!DOCTYPE html>
<html>
<head>
    <title>Restaurants Map</title>
    <link href="./static/css/output.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto p-4">
        <h1 class="text-xl font-bold mb-4">Restaurants</h1>
        <div id="map" class="mb-4"></div>
        <div id="restaurant-list" class="space-y-2">
            {% for name, details in restaurants.items() %}
                <div class="p-4 bg-white rounded shadow">
                    <h2 class="font-semibold">{{ name }}</h2>
                    <p>Rating: {{ details.rating }} ({{ details.num_user_ratings }} reviews)</p>
                </div>
            {% endfor %}
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        const map = L.map('map');
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        let markers = [];
        {% for name, details in restaurants.items() %}
            var marker = L.marker([{{ details.latitude }}, {{ details.longitude }}])
                .bindPopup("{{ name | escape }}")
                .addTo(map);
            markers.push(marker.getLatLng());
        {% endfor %}

        if (markers.length > 0) {
            var bounds = L.latLngBounds(markers);
            map.fitBounds(bounds);
        }
    </script>

</body>
</html>
